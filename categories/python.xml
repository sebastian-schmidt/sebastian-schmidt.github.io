<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>actin.io (python)</title><link>http://actin.io/</link><description></description><atom:link rel="self" href="http://actin.io/categories/python.xml" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sat, 18 Apr 2015 07:55:38 GMT</lastBuildDate><generator>http://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Adobe password leak analyzed with pandas and Python</title><link>http://actin.io/posts/adobe-password-leak-analyzed-with-pandas-and-python.html</link><dc:creator>Sebastian Schmidt</dc:creator><description>&lt;div&gt;&lt;p&gt;I recently found out that one of my throwaway email-accounts was in the Adobe password leak. I wanted to see what was out there and downloaded the leaked data. It looks like this:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;lt;some ID&amp;gt;-|-&amp;lt;username, mostly missing&amp;gt;-|-&amp;lt;email&amp;gt;-|-&amp;lt;password hash&amp;gt;-|-&amp;lt;password hint&amp;gt;|--
103238705-|--|-asdgagr@yahoo.com-|-BB4e6X+b2xLioxG6CatHBw==-|-boyfriend|--
103238706-|--|-fasggfso@hotmail.com-|-Cm8mAzxAiwzioxG6CatHBw==-|-dance|--
103238707-|--|-witdfhadki@gmail.com-|-n+TZlu41zyHioxG6CatHBw==-|-|--
103238708-|--|-isdfahdh8@gmail.com-|-FAniAwP+U13ioxG6CatHBw==-|-|--
103238709-|--|-ojaadf@yahoo.com-|-kxiV+a47bSlf+E5Ulu/AzA==-|-newest|--
103238710-|--|-sahjg@hotmail.com-|-UimSy9NunUU=-|-dog|--
&lt;/pre&gt;
&lt;p&gt;Here's the relevant &lt;a class="reference external" href="http://xkcd.com/1286/"&gt;xkcd&lt;/a&gt;&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="xkcd encryptic" src="http://imgs.xkcd.com/comics/encryptic.png"&gt;&lt;/div&gt;
&lt;p&gt;I put a small script together to convert the file to a tab-separated file. This is probably not necessary, but I didn't have to think much about it and it would be easier later on. I do all this with in an &lt;a class="reference external" href="http://docs.continuum.io/anaconda/"&gt;Anaconda 3.4&lt;/a&gt; installation.&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;csv&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'cred.csv'&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;userDict&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;'idnumber'&lt;/span&gt;&lt;span class="p"&gt;:[],&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-5"&gt;&lt;/a&gt;          &lt;span class="s"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;:[],&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-6"&gt;&lt;/a&gt;          &lt;span class="s"&gt;'emailfront'&lt;/span&gt;&lt;span class="p"&gt;:[],&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-7"&gt;&lt;/a&gt;          &lt;span class="s"&gt;'emailprovider'&lt;/span&gt;&lt;span class="p"&gt;:[],&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-8"&gt;&lt;/a&gt;          &lt;span class="s"&gt;'passwordhash'&lt;/span&gt;&lt;span class="p"&gt;:[],&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-9"&gt;&lt;/a&gt;          &lt;span class="s"&gt;'hint'&lt;/span&gt;&lt;span class="p"&gt;:[]}&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;rowsList&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"rt"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;in_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'converted.tsv'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;newline&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;''&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;out_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;csvwriter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;out_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;in_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-15"&gt;&lt;/a&gt;            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-16"&gt;&lt;/a&gt;                &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;in_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-18"&gt;&lt;/a&gt;                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-19"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'-|-'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-20"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'@'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-21"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'idnumber'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-22"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-23"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'emailfront'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-24"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'emailprovider'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-25"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'passwordhash'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rstrip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'='&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-26"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'hint'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-27"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rstrip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'='&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-28"&gt;&lt;/a&gt;            &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;IndexError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-29"&gt;&lt;/a&gt;                &lt;span class="c"&gt;#print('oops', text)&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-30"&gt;&lt;/a&gt;                &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-31"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c193ae986a7a48a69d7bc1507f7daf47-32"&gt;&lt;/a&gt;                &lt;span class="n"&gt;csvwriter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Next i wrote a small script to check for my email:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_c44579c1596c42b486ccd9df7134da8c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'converted.tsv'&lt;/span&gt;
&lt;a name="rest_code_c44579c1596c42b486ccd9df7134da8c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'test'&lt;/span&gt;
&lt;a name="rest_code_c44579c1596c42b486ccd9df7134da8c-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;'r'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;out_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c44579c1596c42b486ccd9df7134da8c-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;out_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c44579c1596c42b486ccd9df7134da8c-5"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c44579c1596c42b486ccd9df7134da8c-6"&gt;&lt;/a&gt;            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;sample output:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_dc0f04301b144da7906762648148ca40-1"&gt;&lt;/a&gt;12345990                name    gmail.com        sKZcyHioxGNzioxG6CfCw   dog
&lt;/pre&gt;&lt;p&gt;I like the pseudo code style of python :-). My password hint is dog and I can see my hash. Now my interest was peaked and I wanted to see what I can learn from this dataset. Here, I thought it is a good idea to learn a bit about pandas. I come from a Matlab environment for data wrangling and wanted to see what python has to offer.&lt;/p&gt;
&lt;p&gt;Using &lt;a class="reference external" href="http://pandas.pydata.org/"&gt;pandas&lt;/a&gt; this is pretty straightforward. Since my computer doesn't have enough memory I used only the first 10000000 entries. I will probably next look into ways to work faster with that much data. Here is the iphyton notebook used:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'converted.tsv'&lt;/span&gt;
&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nrows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10000000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;usecols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'emailfront'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;'emailprovider'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;'passwordhash'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;'hint'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;toc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_36cf45a5db244a11b256e3c8e64a4c11-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'[*] Time to read data: '&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;toc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tic&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
[*] Time to read data:  19.532169279833354
&lt;/pre&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_98a128dda2614485a437b3c36af143d3-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'[*] rowcount: '&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
[*] rowcount:  10000000
&lt;/pre&gt;
&lt;p&gt;The top ten email providers:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_de91cf21051d497bb8a858132f3f18ab-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emailprovider&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
yahoo.com        1285637
gmail.com         937736
aol.com           315863
msn.com           138874
comcast.net       107684
hotmail.co.uk      99280
web.de             83145
gmx.de             65824
sbcglobal.net      64469
dtype: int64
&lt;/pre&gt;
&lt;p&gt;Top 20 password reminders, I was once a &lt;tt class="docutils literal"&gt;usual&lt;/tt&gt; :-):&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_cdb2c2afa0614a0bb4d7af6d9795ce42-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'[*] hints:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hint&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
[*] hints:
 name        53044
??          36036
usual       34571
????        33202
???         25743
me          25246
same        23438
cat         22477
son         18065
daughter    17497
nickname    16957
?????       15753
??????      14079
pet         13315
work        12744
normal      12544
car         12042
my name     11914
love        11381
dtype: int64
&lt;/pre&gt;
&lt;p&gt;Top 20 email names, notice the absence of female names on the list:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_6656e7f320b64f658a69eb8b503dde82-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'[*] front of email:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emailfront&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
[*] front of email:
 webmaster     8236
mail          7246
admin         7216
adobe         6471
sales         4874
john          4677
chris         4522
david         4388
mike          4208
mark          3568
contact       3440
paul          3408
steve         3321
macromedia    3194
peter         2850
michael       2828
support       2818
office        2802
dave          2447
dtype: int64
&lt;/pre&gt;
&lt;p&gt;Now we come to an interesting part. Adobe used always the same algorithm to calculate the hash and did not salt the stored hashes. This results in having the same hash for the same passwords. Here we have a list of the top 20 hashes that are connected to the 20 most common passwords.&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_d8173e726106428dbd1411bc37b6c70e-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'[*] passwordhashes:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;passwordhash&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
[*] passwordhashes:
 L8qbAD3jl3jioxG6CatHBw    37431
j9p+HwtWWT86aMjgZFLzYg    23348
j9p+HwtWWT/ioxG6CatHBw    14591
5djv7ZCI2ws               13368
7LqYzKVeq8I               10862
dQi0asWPYvQ                9701
ukxzEcXU6Pw                8474
WqflwJFYW3+PszVFZo1Ggg     7904
BB4e6X+b2xLioxG6CatHBw     6734
diQ+ie23vAA                6726
kCcUSCmonEA                6616
e6MPXQ5G6a8                6311
4V+mGczxDEA                5902
PMDTbP0LZxu03SwrFUvYGA     5873
xz6PIeGzr6g                4743
hjAYsdUA4+k                4493
5wEAInH22i4                4361
rpkvF+oZzQvioxG6CatHBw     4245
j9p+HwtWWT8/HeZN+3oiCQ     4142
dtype: int64
&lt;/pre&gt;
&lt;p&gt;To come full circle to the xkcd comic, we pull the most common hints for the ten most common passwords(hashes). It is left to the reader to solve these.&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_6c1803dc2bcd4701bda6d7c41d8c2a1b-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;hash_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;hash_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;passwordhash&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tolist&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_6c1803dc2bcd4701bda6d7c41d8c2a1b-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;hash_list&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_6c1803dc2bcd4701bda6d7c41d8c2a1b-3"&gt;&lt;/a&gt;    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'[*] hash: '&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_6c1803dc2bcd4701bda6d7c41d8c2a1b-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hint&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;adobeDataFrames&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'passwordhash'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="literal-block"&gt;
[*] hash:  L8qbAD3jl3jioxG6CatHBw
pw          282
usual       261
same        225
easy        205
hint        201
word        172
duh         141
wordpass    141
obvious     140
dtype: int64
[*] hash:  j9p+HwtWWT86aMjgZFLzYg
123          496
numbers      442
1-9          286
987654321    281
123456       275
number       180
1            122
19           109
12345         96
dtype: int64
[*] hash:  j9p+HwtWWT/ioxG6CatHBw
1-8         177
123         136
number      135
numeros     113
87654321     83
1234         74
123456       71
18           57
1            50
dtype: int64
[*] hash:  5djv7ZCI2ws
ytrewq    149
q         111
qw         79
asdfgh     67
qwert      65
qwe        63
key        61
qy         47
123456     41
dtype: int64
[*] hash:  7LqYzKVeq8I
222222     120
111         63
123456      62
11          54
one         50
numbers     39
61          37
number      33
6           31
dtype: int64
[*] hash:  dQi0asWPYvQ
123         128
numeros     123
1-7         115
7654321      90
123456       81
number       80
1            50
12           47
12345678     47
dtype: int64
[*] hash:  ukxzEcXU6Pw
Series([], dtype: int64)
[*] hash:  WqflwJFYW3+PszVFZo1Ggg
flash            13
software          8
macro             7
company           6
mac               5
company name      4
programa          4
manufacturer      3
software name     3
dtype: int64
[*] hash:  BB4e6X+b2xLioxG6CatHBw
123           45
usual         24
adobe 123     21
site          18
software      18
123adobe      18
name          17
company123    16
Adobe         15
dtype: int64
&lt;/pre&gt;
&lt;p&gt;I will stop here. There is much more information in here. For instance the hash itself can tell you about the password length. An interesting article can be found on &lt;a class="reference external" href="https://nakedsecurity.sophos.com/2013/11/04/anatomy-of-a-password-disaster-adobes-giant-sized-cryptographic-blunder/"&gt;naked security&lt;/a&gt;. I am very happy with my first pandas experience and definitivly use it again.&lt;/p&gt;&lt;/div&gt;</description><category>pandas</category><category>python</category><category>security</category><guid>http://actin.io/posts/adobe-password-leak-analyzed-with-pandas-and-python.html</guid><pubDate>Wed, 15 Apr 2015 20:38:53 GMT</pubDate></item></channel></rss>